CREATE DATABASE ORG;
SHOW databases;
USE ORG;

CREATE TABLE WORKERS (
    WORKER_ID INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    FIRST_NAME CHAR(25),
    LAST_NAME CHAR(25),
    SALARY INT(25),
    JOINING_DATE DATETIME,
    DEPARTMENT CHAR(25)
);

INSERT INTO WORKERS(WORKER_ID,FIRST_NAME,LAST_NAME,SALARY,JOINING_DATE,DEPARTMENT) values
(001,'YASH','SHRIVASTAVA',100000,'15-02-21 09.00.00','ANALYST'),
(002, 'Niharika', 'Verma', 80000, '14-06-11 09.00.00', 'Admin'),
(003, 'Vishal', 'Singhal', 300000, '14-02-20 09.00.00', 'HR'),
(004, 'Amitabh', 'Singh', 500000, '14-02-20 09.00.00', 'Admin'),
(005, 'Vivek', 'Bhati', 500000, '14-06-11 09.00.00', 'Admin'),
(006, 'Vipul', 'Diwan', 200000, '14-06-11 09.00.00', 'Account'),
(007, 'Satish', 'Kumar', 75000, '14-01-20 09.00.00', 'Account'),
(008, 'Geetika', 'Chauhan', 90000, '14-04-11 09.00.00', 'Admin');

CREATE TABLE BONOUS(WORKER_REF_ID INT, 
BONOUS_AMOUNT INT(20), 
BONOUS_DATE DATETIME, 
FOREIGN KEY (WORKER_REF_ID) 
REFERENCES Workers(WORKER_ID) 
ON DELETE CASCADE
);

insert into bonous(WORKER_REF_ID, BONOUS_AMOUNT, BONOUS_DATE) VALUES
		(001, 5000, '16-02-20'),
		(002, 3000, '16-06-11'),
		(003, 4000, '16-02-20'),
		(001, 4500, '16-02-20'),
		(002, 3500, '16-06-11');
        
CREATE TABLE Title (
	WORKER_REF_ID INT,
	WORKER_TITLE CHAR(25),
	AFFECTED_FROM DATETIME,
	FOREIGN KEY (WORKER_REF_ID)
		REFERENCES Workers(WORKER_ID)
        ON DELETE CASCADE
);

INSERT INTO Title 
	(WORKER_REF_ID, WORKER_TITLE, AFFECTED_FROM) VALUES
 (001, 'Manager', '2016-02-20 00:00:00'),
 (002, 'Executive', '2016-06-11 00:00:00'),
 (008, 'Executive', '2016-06-11 00:00:00'),
 (005, 'Manager', '2016-06-11 00:00:00'),
 (004, 'Asst. Manager', '2016-06-11 00:00:00'),
 (007, 'Executive', '2016-06-11 00:00:00'),
 (006, 'Lead', '2016-06-11 00:00:00'),
 (003, 'Lead', '2016-06-11 00:00:00');
 
 select FIRST_NAME AS workers_name
 FROM workers;
 
 select * from workers;
 
 Select upper(FIRST_NAME) FROM workers;
 
 
Select distinct DEPARTMENT FROM WORKERS;

Select substring(FIRST_NAME,1,3) FROM WORKERS

SELECT 
    worker_id, first_name, last_name
FROM
    workers;
    
select ltrim(department) from workers;

select distinct length(department) from workers;

select replace(first_name,'a','A') from workers

SELECT 
    CONCAT(FIRST_NAME, ' ', LAST_NAME) AS COMPLETE_NAME
FROM
    workers;

SELECT 
    *
FROM
    workers
ORDER BY FIRST_NAME ASC

SELECT 
    FIRST_NAME, LAST_NAME, SALARY
FROM
    workers
WHERE
    SALARY > 50000
GROUP BY FIRST_NAME , LAST_NAME
ORDER BY FIRST_NAME , LAST_NAME ASC;

Select count(distinct SALARY)
FROM workers;

SELECT 
    *, AVG(BONOUS_AMOUNT)
FROM
    bonous
GROUP BY WORKER_REF_ID
HAVING AVG(BONOUS_AMOUNT) > 2500

SELECT * FROM WORKERS ORDER BY FIRST_NAME ASC, DEPARTMENT ASC

SELECT * FROM WORKERS WHERE DEPARTMENT LIKE('ADMIN%')

SELECT * FROM WORKERS WHERE DEPARTMENT LIKE('%A%')

SELECT * FROM WORKERS WHERE SALARY BETWEEN '100000' AND '500000';

SELECT 
    *
FROM
    WORKERS
WHERE
    YEAR(JOINING_DATE) BETWEEN '2014' AND '2015'
GROUP BY FIRST_NAME
ORDER BY FIRST_NAME ASC

SELECT SUM(SALARY) FROM WORKERS;

SELECT COUNT(distinct BONOUS_DATE) FROM BONOUS;

SELECT 
    CONCAT(FIRST_NAME, ' ', LAST_NAME), SALARY
FROM
    WORKERS
WHERE
    WORKER_ID IN (SELECT 
            WORKER_ID
        FROM
            workers
        WHERE
            SALARY BETWEEN 50000 AND 100000);
            
SELECT DISTINCT
    workers.FIRST_NAME, TITLE.WORKER_TITLE
FROM
    WORKERS
        INNER JOIN
    TITLE ON WORKERS.WORKER_ID = TITLE.WORKER_REF_ID
        AND TITLE.WORKER_TITLE IN ('MANAGER');
        
SELECT DISTINCT
    BONOUS.BONOUS_AMOUNT, TITLE.WORKER_TITLE
FROM
    bonous
        INNER JOIN
    TITLE ON BONOUS.WORKER_REF_ID = TITLE.WORKER_REF_ID;
    
SELECT DISTINCT
    WORKERS.FIRST_NAME, WORKERS.LAST_NAME, TITLE.WORKER_TITLE
FROM
    WORKERS
        LEFT JOIN
    TITLE ON WORKERS.WORKER_ID = TITLE.WORKER_REF_ID;
    
SELECT DISTINCT
    WORKERS.FIRST_NAME,
    WORKERS.LAST_NAME,
    WORKERS.SALARY,
    TITLE.WORKER_TITLE
FROM
    workers
        RIGHT JOIN
    TITLE ON WORKERS.WORKER_ID = TITLE.WORKER_REF_ID;
    
